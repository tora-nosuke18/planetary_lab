<launch>

    <include file="$(find-pkg-share realsense2_camera)/launch/rs_launch.py">              
        <arg name="enable_fisheye" value="false"/>
        <arg name="enable_depth" value="true"/>
        <arg name="enable_color" value="false"/>
        <arg name="enable_infra1" value="true"/>
        <arg name="enable_infra2" value="true"/>
    </include>

    <node pkg="rtabmap_odom" exec="stereo_odometry" name="stereo_odometry" >
        <remap from="left/image_rect"    to="/camera/camera/infra1/image_rect_raw"/>
        <remap from="left/camera_info"  to="/camera/camera/infra1/camera_info"/>
        <remap from="right/image_rect"   to="/camera/camera/infra2/image_rect_raw"/>
        <remap from="right/camera_info" to="/camera/camera/infra2/camera_info"/>

      <remap from="odom" to="/visual_odom"/>
      <param name="frame_id"  value="base_link"/>
      <!-- <param name="initial_pose " value="0 0 0.33 0 0 0 "/> -->
      <param name="odom_frame_id" value="odom"/>
      <param name="publish_tf" value="true"/>
      <!-- <param name="approx_sync"  value="true"/> -->
      <param name="queue_size" value="10"/>
      <param name="wait_for_transform " value="true"/>
      <param name="Odom/MinInliers" value="12"/>
      <!-- <param name="Odom/RoiRatios"   value="0.03 0.03 0.04 0.04"/> -->
    </node>

    <node  pkg="rtabmap_slam" exec="rtabmap"  name="rtabmap" >
      <param name="frame_id"  value="base_link"/>
      <param name="subscribe_stereo"  value="true"/>
      <param name="subscribe_depth"  value="false"/>
      <param name="approx_sync"      value="false"/>
      <param name="wait_for_transform_duration" value="0.2"/>
      <param name="map_always_update" value="true"/>
      <remap from="rgb/image"       to="/camera/camera/infra1/image_rect_raw"/>
      <remap from="depth/image"      to="/camera/camera/depth/image_rect_raw"/>
      <remap from="rgb/camera_info"      to="/camera/camera/infra1/camera_info"/>
      <remap from="odom" to="/visual_odom"/>
      <param name="queue_size"  value="10"/>
       <param name="Vis/MinInliers"  value="12"/>
       <param name="GridGlobal/MinSize" value="100"/>
       <param name="Mem/UseOdomGravity"  value="true"/>
       <param name="Optimizer/GravitySigma"  value="0.3"/>
       <param name="Vis/MaxDepth"  value="3.5"/>
       <param name="Vis/FeatureType"  value="8" />
    </node>

</launch>